var _TGlobal={createdTerms:0,terminalOpts:[],kbdListen:!1,kbdCb:null,lastPrintElem:null,inputString:"",kbdSecret:0,kbdShiftHeld:!1,kbdCtrlHeld:!1};function locateCharFromMap(a,b){switch(b.keyCode){case 32:return" ";default:return b.key[0].toString();}}var TerminalOptions=function(){this.fontSize="12px",this.cursorBlink=!0,this.fontFamily="monospace",this.backColor="#000000",this.foreColor="#FFFFFF"},PrintStyleOptions=function(){this.backColor="inherit",this.foreColor="inherit"},Terminal=function(a,b,c,d){this.container="string"==typeof a?document.getElementById(a):a,this.termId=`term_${_TGlobal.createdTerms}`,this.textContainerId=`${this.termId}_textContainer`;var e=null==d?new TerminalOptions:d;this.textContainer=null,this.backColor=e.backColor,this.foreColor=e.foreColor,this.cursorBlink=e.cursorBlink,this.fontSize=e.fontSize,this.fontFamily=e.fontFamily,this.width=b,this.height=c,this.cursor=null,this.termInit=function(){this.textContainer=document.createElement("div"),this.textContainer.style.backgroundColor=this.backColor,this.textContainer.style.color=this.foreColor,this.textContainer.style.fontSize=this.fontSize,this.textContainer.style.fontFamily=this.fontFamily,this.textContainer.style.fontWeight=900,this.textContainer.style.overflowX="hidden",this.textContainer.style.maxWidth="number"==typeof this.width?`${this.width}px`:this.width,this.container.style.backgroundColor=this.backColor,this.container.style.width="number"==typeof this.width?`${this.width}px`:this.width,this.container.style.height="number"==typeof this.height?`${this.height}px`:this.height,this.container.style.overflowY="scroll",this.cursor=document.createElement("span"),this.cursor.innerHTML="&nbsp;",this.cursor.style.backgroundColor="#FFFFFF",this.cursor.setAttribute("id",`${this.termId}_cursor`),this.cursor.style.display="inline",this.textContainer.appendChild(this.cursor),this.container.appendChild(this.textContainer),this.cursorBlink&&setInterval(()=>{this.cursor.style.display="none"==this.cursor.style.display?"inline":"none"},500)},this.clear=function(){this.textContainer.innerHTML="",this.textContainer.appendChild(this.cursor)},this.print=function(a,b,c){this.textContainer.removeChild(this.cursor);var d=document.createElement("span");if("string"!=typeof a)try{d.innerText=JSON.stringify(a,null,4)}catch(b){d.innerText=a.toString()}else d.innerText=a;d.style.whiteSpace="pre-line",d.style.display="inline",null!=c&&("inherit"!=c.foreColor&&(d.style.color=c.foreColor),"inherit"!=c.backColor&&(d.style.color=c.backColor),d.style.fontWeight=900),b&&(d.setAttribute(`is_kbd_char${_TGlobal.kbdSecret}`,"true")," "==a&&(d.innerHTML="&nbsp")),_TGlobal.lastPrintElem=d,this.textContainer.appendChild(d),this.textContainer.appendChild(this.cursor),this.scrollUpdate()},this.printHtml=function(a){this.textContainer.removeChild(this.cursor);var b=document.createElement("span");b.innerHTML=a,b.style.display="inline",b.innerHTML+="<br>",this.textContainer.appendChild(b),this.textContainer.appendChild(this.cursor),this.scrollUpdate()},this._keyboardListenerUp=function(a){switch(a.keyCode){case 16:_TGlobal.kbdShiftHeld=!1;break;case 17:_TGlobal.kbdCtrlHeld=!1;}},this._keyboardListener=function(a){switch(_TGlobal.kbdListen=!0,a.keyCode){default:var b=locateCharFromMap(_TGlobal.kbdShiftHeld,a);_TGlobal.inputString+=b,_TGlobal.t.print(b,!0);break;case 16:_TGlobal.kbdShiftHeld=!0;break;case 17:_TGlobal.kbdCtrlHeld=!0;break;case 32:_TGlobal.inputString+=" ",_TGlobal.t.print(" ",!0);break;case 20:break;case 13:_TGlobal.t.print("\n",!0),_TGlobal.kbdListen=!1,document.removeEventListener("keydown",_TGlobal.t._keyboardListener,!0),document.removeEventListener("keyup",_TGlobal.t._keyboardListenerUp,!0),_TGlobal.kbdCb(_TGlobal.t,_TGlobal.inputString);break;case 8:if(2<!_TGlobal.t.textContainer.children.length)return;var c=_TGlobal.t.textContainer.children[term.textContainer.children.length-2];if(null==c.getAttribute(`is_kbd_char${_TGlobal.kbdSecret}`)||"true"!=c.getAttribute(`is_kbd_char${_TGlobal.kbdSecret}`))return;_TGlobal.t.textContainer.removeChild(c),_TGlobal.inputString=_TGlobal.inputString.substring(0,_TGlobal.inputString.length-1);}},this.input=function(a){_TGlobal.kbdListen||(_TGlobal.inputString="",_TGlobal.kbdCb=a,_TGlobal.t=this,_TGlobal.kbdSecret=Math.round(1e3*Math.random()),document.addEventListener("keydown",this._keyboardListener,!0),document.addEventListener("keyup",this._keyboardListenerUp,!0))},this.println=function(a){this.print(`${a}\n`)},this.scrollUpdate=function(){this.container.scrollTop=this.container.scrollHeight}};